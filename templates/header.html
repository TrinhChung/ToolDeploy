<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Header</title>
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
	<style>
		body {
			padding-top: 60px;
		}

		.dropdown-item.active,
		.dropdown-item:active {
			background-color: #212529;
		}

		.navbar-brand {
			display: flex;
			align-items: center;
			gap: 10px;
		}

		.navbar-brand img {
			height: 32px;
			width: auto;
			object-fit: contain;
		}

		.logo {
			width: 40px;
			height: 40px;
			background-color: #4267B2;
			color: white;
			font-weight: bold;
			font-size: 24px;
			text-align: center;
			line-height: 40px;
			border-radius: 0;
			display: inline-block;
		}

		@media (max-width: 576px) {
			.navbar-brand img {
				height: 28px;
			}
		}

		@media (max-width: 991.98px) {
			.navbar-nav .dropdown-menu {
				position: static;
				float: none;
			}
		}

		@media (min-width: 992px) {
			.dropdown:hover .dropdown-menu {
				display: block;
				margin-top: 0;
			}
		}
	</style>
</head>

<body>
	<header class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
		<nav class="container-fluid">
			<a class="navbar-brand" href="#">
				<div class="logo">{{ app_name[0]|upper }}</div>
				<span class="app-title">{{ app_name }}</span>
			</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
				aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ms-auto">
					<li class="nav-item">
						<a class="nav-link" href="/">Home</a>
					</li>

					<!-- Quản lý Server Dropdown -->
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="serverDropdown" role="button"
							data-bs-toggle="dropdown" aria-expanded="false">
							Quản lý Server
						</a>
						<ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="serverDropdown">
							<li>
								<a class="dropdown-item" href="/server/servers">
									<i class="fa fa-server me-1"></i> Danh sách Server
								</a>
							</li>
							{% if current_user.is_authenticated and current_user.is_admin %}
							<li>
								<a class="dropdown-item" href="/server/server/add">
									<i class="fa fa-plus me-1"></i> Thêm Server mới
								</a>
							</li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li>
								<a class="dropdown-item" href="{{ url_for('deployed_app.list_app') }}">
									<i class="fa fa-th-list me-1"></i> Danh sách App Đã Deploy
								</a>
							</li>
							<li>
								<a class="dropdown-item" href="{{ url_for('deployed_app.deploy_app') }}">
									<i class="fa fa-plus me-1"></i> Deploy App mới
								</a>
							</li>
							<!-- ==== Thêm GenWeb tại đây ==== -->
							<li>
								<hr class="dropdown-divider">
							</li>
							<li>
								<a class="dropdown-item" href="{{ url_for('genweb.list_website') }}">
									<i class="fa fa-globe me-1"></i> Danh sách Website GenWeb
								</a>
							</li>
							<li>
								<a class="dropdown-item" href="{{ url_for('genweb.create_website') }}">
									<i class="fa fa-plus me-1"></i> Tạo Website mới (GenWeb)
								</a>
							</li>
							{% endif %}
						</ul>
					</li>


					<!-- Quản lý Domain & DNS Dropdown -->
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="domainDropdown" role="button"
							data-bs-toggle="dropdown" aria-expanded="false">
							Quản lý Domain
						</a>
						<ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="domainDropdown">
							<li>
								<a class="dropdown-item" href="/domain/list">
									<i class="fa fa-list-ul me-1"></i> Danh sách Domain
								</a>
							</li>
							<li>
								<a class="dropdown-item" href="/domain/add">
									<i class="fa fa-plus me-1"></i> Thêm Domain mới
								</a>
							</li>
							{% if current_user.is_authenticated and current_user.is_admin %}
							<li>
								<hr class="dropdown-divider">
							</li>
							<li>
								<a class="dropdown-item" href="/cloudflare/accounts">
									<i class="fa fa-cloud me-1"></i> Cloudflare Accounts
								</a>
							</li>
							<li>
								<a class="dropdown-item" href="/cloudflare/add">
									<i class="fa fa-plus me-1"></i> Thêm Cloudflare Account
								</a>
							</li>
							{% endif %}
						</ul>
					</li>


					{% if current_user.is_authenticated and current_user.is_admin %}
					<!-- Admin Dropdown -->
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button"
							data-bs-toggle="dropdown" aria-expanded="false">
							Admin
						</a>
						<ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="adminDropdown">
							<li>
								<a class="dropdown-item" href="{{ url_for('admin.manage_users') }}">Quản lý User</a>
							</li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li>
								<a class="dropdown-item" href="/admin/logs">Xem logs</a>
							</li>
						</ul>
					</li>
					{% endif %}

					<!-- Legal Dropdown -->
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="legalDropdown" role="button"
							data-bs-toggle="dropdown" aria-expanded="false">
							Legal
						</a>
						<ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="legalDropdown">
							<li><a class="dropdown-item" target="_blank" href="/polices">Privacy Policy</a></li>
							<li><a class="dropdown-item" target="_blank" href="/permissions">Permissions</a></li>
						</ul>
					</li>

					<!-- Authentication -->
					{% if current_user.is_authenticated %}
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('auth.logout') }}">Logout</a>
					</li>
					{% else %}
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>
					</li>
					{% endif %}
				</ul>
			</div>
		</nav>
	</header>

	<!-- jQuery (optional, recommended for compatibility) -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<!-- Popper.js -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
	<!-- Script xử lý dropdown -->
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			// Dropdown trên mobile
			var dropdowns = document.querySelectorAll('.dropdown-toggle');
			dropdowns.forEach(function (dropdown) {
				dropdown.addEventListener('click', function (e) {
					if (window.innerWidth < 992) {
						e.preventDefault();
						var menu = this.nextElementSibling;
						menu.classList.toggle('show');
					}
				});
			});
			// Dropdown hover trên desktop
			if (window.innerWidth >= 992) {
				var dropdownItems = document.querySelectorAll('.dropdown');
				dropdownItems.forEach(function (item) {
					item.addEventListener('mouseover', function () {
						this.querySelector('.dropdown-menu').classList.add('show');
					});
					item.addEventListener('mouseleave', function () {
						this.querySelector('.dropdown-menu').classList.remove('show');
					});
				});
			}
		});
	</script>
</body>

</html>